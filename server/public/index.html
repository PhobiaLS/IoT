<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <title>Esplora</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/esplora.css">
    <link rel="stylesheet" type="text/css" href="css/range.css">
    <link rel="stylesheet" type="text/css" href="css/piano.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script src="https://cdn.socket.io/socket.io-1.3.6.js"></script>
    <script src="js/esplora.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="header clearfix" style="margin-top:20px">
        <nav>
          <ul class="nav nav-pills pull-right" style="font-size: 16pt">
            <li role="presentation" class="active"><a href="index.html">Home</a></li>
            <li role="presentation"><a href="about.html">About</a></li>
          </ul>
        </nav>
        <h3 class="text-muted" style="font-size: 25pt;margin-top:5px">ESPLORA</h3>
      </div>
      <hr>
      <div class="row">
          <div class="col-md-6" style="margin-bottom:20px">
                <div class="row headerStyle" >
                    <p class="titleStyle">Movement control</p>
                </div>
                <div id="divOutside" >
                    <div id="divInside"></div>
                    <div id="divInsideJoystick"></div>
                </div>
                <div class="row headerStyle" >
                    <p class="titleStyle">Temperature</p>
                </div>
                <div id="temp" style="position:relative;margin-bottom:30px">
                    <div id="time" class="genStyle"></div>
                    <div id="cels" class="genStyle"  style="display:inline;position:absolute;top:90%"> 째C</div>
                    <div id="far" class="genStyle" style="display:inline;position:absolute;top:90%;left:70%" > 째F</div>
                </div>
                <div class="row headerStyle" >
                    <p class="titleStyle">Volume</p>
                </div>
                <div class="progress">
                    <div id="volumeProgress" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 50%;">
                    </div>
                </div>
                <div class="row headerStyle" >
                    <p class="titleStyle">Slider</p>
                </div>
                <div class="progress">
                    <div id="sliderProgress" class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 50%;">
                    
                    </div>
                </div>
                 
          </div>
          <div class="col-md-6" style="overflow: hidden">
                <div class="row headerStyle" >
                    <p class="titleStyle"><span style="color:red">R</span><span style="color:greenyellow">G</span><span style="color:dodgerblue">B</span> led control</p>
                </div>
                <div style="margin-bottom:40px;overflow: hidden">
                    <div id="RGB"></div> 
                    <div class="innerRGB">
                        <span class="rgbSpan">Red:</span>
                        <div class="range range-red" style="width:75%;float:left;margin-top:0px;margin-left:47px">  
                            <input type="range" id="rangeRed" name="range" min="0" max="255" value="0" onchange="rangeORed.value=value; sendRGB();">
                            <output id="rangeORed">0</output>
                        </div>
                    </div>
                    <div class="innerRGB">
                        <span class="rgbSpan">Green:</span>
                        <div class="range range-success" style="width:75%;float:left;margin-top:0px;margin-left:30px">  
                            <input type="range" id="rangeGreen" name="range" min="0" max="255" value="0" onchange="rangeOGreen.value=value; sendRGB();">
                            <output id="rangeOGreen">0</output>
                        </div>
                    </div>
                    <div class="innerRGB">
                        <span class="rgbSpan">Blue:</span>
                        <div class="range range-primary" style="width:75%;float:left;margin-top:0px;margin-left:45px">  
                            <input type="range" id="rangeBlue" name="range" min="0" max="255" value="0" onchange="rangeOBlue.value=value; sendRGB();">
                            <output id="rangeOBlue">0</output>
                        </div>
                    </div>
                    <div style="overflow: hidden;float:left;width:50%">
                        <span class="rgbSpan">Pause:</span>
                        <div class="range range-warning" style="width:50%;float:left;margin-top:0px;margin-left:29px">  
                            <input type="range" id="rangePause" name="range" min="500" max="5000" value="0" onchange="rangeOPause.value=value; sendRGB()">
                            <output id="rangeOPause">500</output>
                        </div>
                    </div>
                    <div style="overflow: hidden;float:left;width:50%">
                        <span class="rgbSpan">Signal:</span>
                        <div class="range range-warning" style="width:50%;float:left;margin-top:0px;margin-left:29px">  
                            <input type="range" id="rangeSignal" name="range" min="500" max="5000" value="0" onchange="rangeOSignal.value=value; sendRGB();">
                            <output id="rangeOSignal">500</output>
                        </div>
                    </div>
                </div>
                <div class="row headerStyle" >
                    <p class="titleStyle">Piezo control</p>
                </div>
                <div style="margin-bottom:40px;height:180px;" id="kbd">
                    <div id="keys">
                        <div id="keyC" value="C" onclick="sendKey(this)" class="note white">C</div>
                        <div id="keyC#" value="C#" onclick="sendKey(this)" class="note black">C#</div>
                        <div id="keyD" value="D" onclick="sendKey(this)" class="note white">D</div>
                        <div id="keyD#" value="D#" onclick="sendKey(this)" class="note black">D#</div>
                        <div id="keyE" value="E" onclick="sendKey(this)" class="note white">E</div>
                        <div id="keyF" value="F" onclick="sendKey(this)" class="note white">F</div>
                        <div id="keyF#" value="F#" onclick="sendKey(this)" class="note black">F#</div>
                        <div id="keyG" value="G" onclick="sendKey(this)" class="note white">G</div>
                        <div id="keyG#" value="G#" onclick="sendKey(this)" class="note black">G#</div>
                        <div id="keyA" value="A" onclick="sendKey(this)" class="note white">A</div>
                        <div id="keyA#" value="A#" onclick="sendKey(this)" class="note black">A#</div>
                        <div id="keyB" value="B" onclick="sendKey(this)" class="note white">B</div>
                        <div id="keyC1" value="C1" onclick="sendKey(this)" class="note white">C</div>
                    </div>
                </div>
                <div class="row headerStyle" >
                    <p class="titleStyle">Light</p>
                </div>
                <div id="ligth" style="position:relative;width:200px"  class="col-md-offset-4 col-sm-offset-4 col-lg-offset-4">
                    <img src="images/bulb.png" width="100%">
                </div>
          </div>
      </div>
  </body>
  <script>
        var socket = io.connect("127.0.0.1:3000/");
        $("#time").text(new Date().toLocaleString());

        function sendKey(key){
            var keyValue = $(key).attr("value");
            socket.emit("sendEsplora",{PiezoPlay:keyValue});
        }

    socket.on('results', function(data)
    {
        data = JSON.parse(data);
        if(data.hasOwnProperty('up')){
            if(parseInt(data.up)==0) moveInsideUp();
            if(parseInt(data.down)==0) moveInsideDown();
            if(parseInt(data.right)==0) moveInsideRight();
            if(parseInt(data.left)==0) moveInsideLeft();
        }

        if(data.hasOwnProperty('celsius')){
            $("#cels").text(parseInt(data.celsius)+" 째C");
            $("#far").text(parseInt(data.fahrenheit)+" 째F");
            $("#time").text(new Date().toLocaleString());
        }

        if(data.hasOwnProperty('joystickX')) joystickMove(parseInt(data.joystickX),parseInt(data.joystickY),parseInt(data.button));
        
        if(data.hasOwnProperty('light')){
            var numb = parseInt(data.light);
            
            changeBrightness(numb);
        }
        
        if(data.hasOwnProperty('loudness')){
            var loudness = parseInt(data.loudness);
            var loud = map(loudness,0,1023,0,100);
            $("#volumeProgress").css({"width":loud+"%"});
        }

        if(data.hasOwnProperty('slider')){
            var slide = map(parseInt(data.slider),0,1023,0,100); 
            $("#sliderProgress").css({"width":(100-slide)+"%"});
        }
    });
    
  </script>
</html>